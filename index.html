<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title></title>
		<!-- <script src="./js/排序.js"></script> -->
	</head>
	<body>
		<script>
			class Sort {
				constructor(originalCallbacks) {
					this.callbacks = Sort.initSortingCallbacks(originalCallbacks);
					this.comparator = new Comparator(this.callbacks.compareCallback);
					console.log("Sort类的构造器：",this.callbacks);
				}
				static initSortingCallbacks(originalCallbacks) {
					//创建一个对象
					const callbacks = originalCallbacks || {};
					const stubCallback = () => {};
					

					//添加两个属性
					callbacks.compareCallback = callbacks.compareCallback || undefined;
					callbacks.visitingCallback = callbacks.visitingCallback || stubCallback;
					console.log("这里的回调函数=",callbacks.visitingCallback);
					
					return callbacks;
				}
				sort() {
					throw new Error('sort method must be implemented');
				}
			}

			class BubbleSort extends Sort {
				
				sort(originalArray) {
					let swapped = false;
					const array = [...originalArray];

					for (let i = 1; i < array.length; i += 1) {
						swapped = false;
						this.callbacks.visitingCallback(array[i]);

						for (let j = 0; j < array.length - i; j += 1) {
							// Call visiting callback.
							this.callbacks.visitingCallback(array[j]);
							if (this.comparator.lessThan(array[j + 1], array[j])) {
								
								[array[j], array[j + 1]] = [array[j + 1], array[j]];
								swapped = true;
								
							}
						}
						// if (!swapped) {
						// 	return array;
						// }
					}
					return array;
				}
			}

			class Comparator {
				//如果存在回调函数
				//相等为0，小于为负数，大于为正数
				constructor(compareFunction) {
					this.compare = compareFunction || Comparator.defaultCompareFunction;
					// console.log("comparator构造器：",this.compare)
				}
				static defaultCompareFunction(a, b) {
					if (a === b) {
						return 0;
					}
					return a < b ? -1 : 1;
				}
				equal(a, b) {
					return this.compare(a, b) === 0;
				}
				lessThan(a, b) {
					return this.compare(a, b) < 0;
				}
				greaterThan(a, b) {
					return this.compare(a, b) > 0;
				}
				lessThanOrEqual(a, b) {
					return this.lessThan(a, b) || this.equal(a, b);
				}
				greaterThanOrEqual(a, b) {
					return this.greaterThan(a, b) || this.equal(a, b);
				}
				reverse() {
					const compareOriginal = this.compare;
					this.compare = (a, b) => compareOriginal(b, a);
				}
			}


			function bs2(arr){
				for(let i=1;i<arr.length;i++){
					for(let j=0;j<arr.length-i;j++){
						if(arr[j]>arr[j+1]){
							[arr[j],arr[j+1]]=[arr[j+1],arr[j]];
						}
					}
				}
				return arr;
			}
			
			let arr = [8, 1, 4, 3,77,-1,3,2,8,5];
			// let obj=new BubbleSort(()=>{
			// 	console.log("我是你爹");
			// });
			// let arr2=obj.sort(arr);
			// for(let i=0;i<5;i++){
			// 	[arr[i], arr[i+1]] = [6,1];
			// 	console.log([arr[i], arr[i+1]]);
			// }
		    let arr2=bs2(arr);
			console.log("输出：",arr2);
			
			
			
		</script>
	</body>
</html>
